{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nexports.__esModule = true;\nexports.propagateErrors = propagateErrors;\nexports.settled = settled;\nexports.collectErrors = collectErrors;\nexports.default = runValidations;\nvar _objectWithoutPropertiesLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutPropertiesLoose\"));\nvar _synchronousPromise = require(\"synchronous-promise\");\nvar _ValidationError = _interopRequireDefault(require(\"../ValidationError\"));\nvar promise = function promise(sync) {\n  return sync ? _synchronousPromise.SynchronousPromise : Promise;\n};\nvar unwrapError = function unwrapError(errors) {\n  if (errors === void 0) {\n    errors = [];\n  }\n  return errors.inner && errors.inner.length ? errors.inner : [].concat(errors);\n};\nfunction scopeToValue(promises, value, sync) {\n  //console.log('scopeToValue', promises, value)\n  var p = promise(sync).all(promises); //console.log('scopeToValue B', p)\n\n  var b = p.catch(function (err) {\n    if (err.name === 'ValidationError') err.value = value;\n    throw err;\n  }); //console.log('scopeToValue c', b)\n\n  var c = b.then(function () {\n    return value;\n  }); //console.log('scopeToValue d', c)\n\n  return c;\n}\n/**\n * If not failing on the first error, catch the errors\n * and collect them in an array\n */\n\nfunction propagateErrors(endEarly, errors) {\n  return endEarly ? null : function (err) {\n    errors.push(err);\n    return err.value;\n  };\n}\nfunction settled(promises, sync) {\n  var Promise = promise(sync);\n  return Promise.all(promises.map(function (p) {\n    return Promise.resolve(p).then(function (value) {\n      return {\n        fulfilled: true,\n        value: value\n      };\n    }, function (value) {\n      return {\n        fulfilled: false,\n        value: value\n      };\n    });\n  }));\n}\nfunction collectErrors(_ref) {\n  var validations = _ref.validations,\n    value = _ref.value,\n    path = _ref.path,\n    sync = _ref.sync,\n    errors = _ref.errors,\n    sort = _ref.sort;\n  errors = unwrapError(errors);\n  return settled(validations, sync).then(function (results) {\n    var nestedErrors = results.filter(function (r) {\n      return !r.fulfilled;\n    }).reduce(function (arr, _ref2) {\n      var error = _ref2.value;\n\n      // we are only collecting validation errors\n      if (!_ValidationError.default.isError(error)) {\n        throw error;\n      }\n      return arr.concat(error);\n    }, []);\n    if (sort) nestedErrors.sort(sort); //show parent errors after the nested ones: name.first, name\n\n    errors = nestedErrors.concat(errors);\n    if (errors.length) throw new _ValidationError.default(errors, value, path);\n    return value;\n  });\n}\nfunction runValidations(_ref3) {\n  var endEarly = _ref3.endEarly,\n    options = (0, _objectWithoutPropertiesLoose2.default)(_ref3, [\"endEarly\"]);\n  if (endEarly) return scopeToValue(options.validations, options.value, options.sync);\n  return collectErrors(options);\n}","map":{"version":3,"names":["_interopRequireDefault","require","exports","__esModule","propagateErrors","settled","collectErrors","default","runValidations","_objectWithoutPropertiesLoose2","_synchronousPromise","_ValidationError","promise","sync","SynchronousPromise","Promise","unwrapError","errors","inner","length","concat","scopeToValue","promises","value","p","all","b","catch","err","name","c","then","endEarly","push","map","resolve","fulfilled","_ref","validations","path","sort","results","nestedErrors","filter","r","reduce","arr","_ref2","error","isError","_ref3","options"],"sources":["/Users/GAMJA/Desktop/nodejs프로젝트/boilerplate-mern-stack-master/client/node_modules/yup/lib/util/runValidations.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.propagateErrors = propagateErrors;\nexports.settled = settled;\nexports.collectErrors = collectErrors;\nexports.default = runValidations;\n\nvar _objectWithoutPropertiesLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutPropertiesLoose\"));\n\nvar _synchronousPromise = require(\"synchronous-promise\");\n\nvar _ValidationError = _interopRequireDefault(require(\"../ValidationError\"));\n\nvar promise = function promise(sync) {\n  return sync ? _synchronousPromise.SynchronousPromise : Promise;\n};\n\nvar unwrapError = function unwrapError(errors) {\n  if (errors === void 0) {\n    errors = [];\n  }\n\n  return errors.inner && errors.inner.length ? errors.inner : [].concat(errors);\n};\n\nfunction scopeToValue(promises, value, sync) {\n  //console.log('scopeToValue', promises, value)\n  var p = promise(sync).all(promises); //console.log('scopeToValue B', p)\n\n  var b = p.catch(function (err) {\n    if (err.name === 'ValidationError') err.value = value;\n    throw err;\n  }); //console.log('scopeToValue c', b)\n\n  var c = b.then(function () {\n    return value;\n  }); //console.log('scopeToValue d', c)\n\n  return c;\n}\n/**\n * If not failing on the first error, catch the errors\n * and collect them in an array\n */\n\n\nfunction propagateErrors(endEarly, errors) {\n  return endEarly ? null : function (err) {\n    errors.push(err);\n    return err.value;\n  };\n}\n\nfunction settled(promises, sync) {\n  var Promise = promise(sync);\n  return Promise.all(promises.map(function (p) {\n    return Promise.resolve(p).then(function (value) {\n      return {\n        fulfilled: true,\n        value: value\n      };\n    }, function (value) {\n      return {\n        fulfilled: false,\n        value: value\n      };\n    });\n  }));\n}\n\nfunction collectErrors(_ref) {\n  var validations = _ref.validations,\n      value = _ref.value,\n      path = _ref.path,\n      sync = _ref.sync,\n      errors = _ref.errors,\n      sort = _ref.sort;\n  errors = unwrapError(errors);\n  return settled(validations, sync).then(function (results) {\n    var nestedErrors = results.filter(function (r) {\n      return !r.fulfilled;\n    }).reduce(function (arr, _ref2) {\n      var error = _ref2.value;\n\n      // we are only collecting validation errors\n      if (!_ValidationError.default.isError(error)) {\n        throw error;\n      }\n\n      return arr.concat(error);\n    }, []);\n    if (sort) nestedErrors.sort(sort); //show parent errors after the nested ones: name.first, name\n\n    errors = nestedErrors.concat(errors);\n    if (errors.length) throw new _ValidationError.default(errors, value, path);\n    return value;\n  });\n}\n\nfunction runValidations(_ref3) {\n  var endEarly = _ref3.endEarly,\n      options = (0, _objectWithoutPropertiesLoose2.default)(_ref3, [\"endEarly\"]);\n  if (endEarly) return scopeToValue(options.validations, options.value, options.sync);\n  return collectErrors(options);\n}"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}